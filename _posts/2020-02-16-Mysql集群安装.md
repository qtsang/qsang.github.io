---
layout: post
title: Mysql集群安装记录 
categories: 数据库
description: Mysql集群安装记录。
keywords: Mysql,数据库


---

Keepalived+双主集群Mysql搭建过程记录。

### 前言

Mysql支持多种集群方式，用户可以根据自身场景选择合适的集群模式，常用的集群模式如下表:

| 编号 | 集群方式            | 使用说明                                                     |
| :--- | ------------------- | ------------------------------------------------------------ |
| 1    | 主从模式            | 主从复制主要是指将主服务器的DDL和DML操作，通过二进制日志（binLog日志），传到从服务器上，然后在从服务器上对这些日志重新执行，从而实现从服务器与主服务器的数据同步。MySQL支持一台主服务器同时向多台从服务器进行复制。 |
| 2    | 双主模式            | 双主（多主）模式相比主从模式，可以增加数据库入口，在这种复制结构中，两台服务器的任何一台上面的数据库存发生了改变都会同步到另一台服务器上，这样两台服务器互为主从，并且都能向外提供服务 |
| 3    | Keepalived+双主模式 | 使用Keepalived+MySQL双主模式是一种简单、便捷的解决方案，在高可用集群环境中，keepalived使用虚拟VIP，使用Keepalived自带的服务监控功能和自定义脚本来实现MySQL故障时自动切换，非常灵活 |
| 3    | MHA模式             | MHA（Master High Availability）目前在MySQL高可用方面是一个相对成熟的解决方案，在 MySQL故障切换过程中，MHA能做到在 0~30秒之内自动完成数据库的故障切换操作，并且在进行故障切换的过程中，MHA 能在最大程度上保证数据的一致性，以达到真正意义上的高可用 |

Keepalived+双主和MAH模式是目前使用比较多的集群模式，本文使用Keppalived+双主搭建Mysql高可用集群。

##### 1、安装Keepalived

Keepalived在线安装很简单，一条命令搞定。

```shell
yum install keepalived -y
```

也可以离线下载rpm或者tar包安装，这种方式会遇到很多坑，相互依赖太多。

通过rpm找到keepalived的安装目录：

```shell
# rpm -qa | grep -i keepalived
keepalived-1.2.13-8.el7.x86_64
# rpm -ql keepalived-1.2.13-8.el7.x86_64
/etc/keepalived
/etc/keepalived/keepalived.conf
/etc/sysconfig/keepalived
```

